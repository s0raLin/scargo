# 国际化支持

Sinter 使用构建时国际化系统，在编译时生成翻译代码，提供零运行时开销的类型安全翻译。

## 工作原理

1. **翻译文件**: `templates/i18n.json` 包含所有语言的翻译
2. **构建脚本**: `build.rs` 在编译时读取翻译文件并生成 Rust 代码
3. **特性标志**: 通过 Cargo 特性标志选择语言
4. **生成的代码**: 在 `OUT_DIR/i18n.rs` 中生成类型安全的翻译函数

## 使用方法

### 默认构建（英文）

```bash
cargo build
# 或
cargo build --package sinter
```

### 构建中文版本

```bash
cargo build --package sinter --features lang-zh
# 或禁用默认特性，只启用中文
cargo build --package sinter --no-default-features --features lang-zh
```

### 在代码中使用

```rust
use sinter::i18n::{t, tf};

// 简单翻译
println!("{}", t("main_about"));

// 带参数的翻译（使用 {} 占位符）
println!("{}", tf("created_project", &["my-project"]));
```

## 添加新翻译

1. 编辑 `templates/i18n.json`
2. 为每个语言添加对应的键值对
3. 重新构建项目

示例：

```json
{
  "en": {
    "my_new_key": "My new message"
  },
  "zh": {
    "my_new_key": "我的新消息"
  }
}
```

## 添加新语言

1. 在 `templates/i18n.json` 中添加新语言对象
2. 在 `Cargo.toml` 中添加新的特性标志：
   ```toml
   [features]
   lang-ja = []  # 日语
   ```
3. 在 `build.rs` 中添加语言检测逻辑
4. 使用 `--features lang-ja` 构建

## 优势

- ✅ **零运行时开销**: 翻译在编译时确定，无运行时查找
- ✅ **类型安全**: 编译时检查翻译键是否存在
- ✅ **易于维护**: 所有翻译集中在一个 JSON 文件中
- ✅ **多语言构建**: 可以为不同语言构建不同的二进制文件
- ✅ **性能优化**: 字符串字面量直接嵌入二进制文件

## 注意事项

- 翻译文件改变后需要重新构建
- 未找到的翻译键会返回 `"[Translation key not found]"`
- 格式化字符串使用 `{}` 作为占位符，按顺序替换参数

## Rust Analyzer 配置

如果遇到 `OUT_DIR not set` 错误，请确保 rust-analyzer 已配置为运行构建脚本：

在 `.vscode/settings.json` 或 `rust-analyzer` 配置中添加：

```json
{
  "rust-analyzer.cargo.buildScripts.enable": true,
  "rust-analyzer.cargo.buildScripts.useRustcWrapper": true
}
```

或者在项目根目录的 `.cargo/config.toml` 中配置。

**注意**：即使 rust-analyzer 无法运行构建脚本，代码仍然可以正常编译，因为实际构建时 `build.rs` 总是会运行。

